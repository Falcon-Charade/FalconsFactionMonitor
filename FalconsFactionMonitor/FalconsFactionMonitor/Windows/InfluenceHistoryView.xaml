<Window x:Class="FalconsFactionMonitor.Windows.InfluenceHistoryView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:FalconsFactionMonitor.Windows"
        xmlns:oxy="http://oxyplot.org/wpf"
        Title="{DynamicResource InfluenceHistory_Title}"
        Style="{StaticResource MaterialDesignWindow}"
        Height="480"
        Width="854">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <!-- Search Controls -->
        <StackPanel Orientation="Horizontal" Margin="0,0,0,10" Grid.Row="0" VerticalAlignment="Center">
            <RadioButton Content="{DynamicResource InfluenceHistory_Faction}"
                         FontSize="{DynamicResource GlobalFontSize}"
                         IsChecked="{Binding IsFactionSearch, Mode=TwoWay}"
                         Margin="0,0,10,0"/>
            <RadioButton Content="{DynamicResource InfluenceHistory_System}"
                         FontSize="{DynamicResource GlobalFontSize}"
                         IsChecked="{Binding IsSystemSearch, Mode=TwoWay}"
                         Margin="0,0,10,0"/>
            <TextBox Width="200"
                     FontSize="{DynamicResource GlobalFontSize}"
                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                     Margin="0,0,10,0"
                     ToolTip="Enter faction or system name..."/>
            <Button Content="{DynamicResource InfluenceHistory_Button_Report}"
                    Margin="10,0,0,0"
                    FontSize="{DynamicResource GlobalFontSize}"
                    Command="{Binding ReportCommand}"/>
            <Button x:Name="ReportOptionsButton"
                    Margin="8,0,0,0"
                    Content="{DynamicResource InfluenceHistory_Button_ReportOptions}"
                    Click="ReportOptionsButton_Click">
                <Button.ContextMenu>
                    <ContextMenu x:Name="ReportOptionsMenu" Placement="Bottom">
                        <MenuItem Header="{DynamicResource InfluenceHistory_Button_ReportLocationSave}" Command="{Binding SetReportFolderCommand}" />
                        <MenuItem Header="{DynamicResource InfluenceHistory_Button_ReportLocationOpen}" Command="{Binding OpenReportFolderCommand}" />
                    </ContextMenu>
                </Button.ContextMenu>
            </Button>
        </StackPanel>
        <StackPanel Orientation="Horizontal" Margin="0,0,0,10" Grid.Row="1" VerticalAlignment="Center">
            <Label Content="{DynamicResource InfluenceHistory_Start}"
                   FontSize="{DynamicResource GlobalFontSize}"
                   VerticalAlignment="Center"/>
            <DatePicker SelectedDate="{Binding StartDate}"
                        FontSize="{DynamicResource GlobalFontSize}"
                        Width="120"
                        Margin="5,0,10,0"/>
            <Label Content="{DynamicResource InfluenceHistory_End}"
                   FontSize="{DynamicResource GlobalFontSize}"
                   VerticalAlignment="Center"/>
            <DatePicker SelectedDate="{Binding EndDate}"
                        FontSize="{DynamicResource GlobalFontSize}"
                        Width="120"
                        Margin="5,0,10,0"/>
            <TextBlock Text="{DynamicResource InfluenceHistory_Min}"
                       FontSize="{DynamicResource GlobalFontSize}"
                       VerticalAlignment="Center" 
                       Margin="10,0,2,0"/>
            <TextBox Width="60"
                     FontSize="{DynamicResource GlobalFontSize}"
                     Text="{Binding MinInfluence, UpdateSourceTrigger=PropertyChanged}"
                     ToolTip="Enter minimum influence (0–100)"
                     Margin="0,0,10,0"/>
            <TextBlock Text="{DynamicResource InfluenceHistory_Max}"
                       FontSize="{DynamicResource GlobalFontSize}"
                       VerticalAlignment="Center"
                       Margin="0,0,2,0"/>
            <TextBox Width="60"
                     FontSize="{DynamicResource GlobalFontSize}"
                     Text="{Binding MaxInfluence, UpdateSourceTrigger=PropertyChanged}"
                     ToolTip="Enter maximum influence (0–100)" />
            <Button Content="{DynamicResource InfluenceHistory_Button_Search}"
                    Margin="10,0,0,0"
                    FontSize="{DynamicResource GlobalFontSize}"
                    Command="{Binding SearchCommand}"/>
        </StackPanel>
        <!-- 2) The OxyPlot chart -->
        <oxy:PlotView Grid.Row="2"
                      Model="{Binding PlotModel}"
                      Margin="5">
            <oxy:PlotView.DefaultTrackerTemplate>
                <ControlTemplate>
                    <oxy:TrackerControl
        Position="{Binding Position}"
        LineExtents="{Binding PlotModel.PlotArea}">

                        <!-- tracker background -->
                        <oxy:TrackerControl.Background>
                            <SolidColorBrush Color="LightGray"/>
                        </oxy:TrackerControl.Background>

                        <!-- tracker's content: the text -->
                        <oxy:TrackerControl.Content>
                            <!-- Here you set Foreground as needed -->
                            <TextBlock
            Text="{Binding}"
            Margin="7"
            Foreground="Black"/>
                        </oxy:TrackerControl.Content>
                    </oxy:TrackerControl>
                </ControlTemplate>
            </oxy:PlotView.DefaultTrackerTemplate>
        </oxy:PlotView>
    </Grid>
</Window>